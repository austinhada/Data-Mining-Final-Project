dat <- read.csv("imputedData.csv")
dat
nrow(dat)
knitr::opts_chunk$set(echo = TRUE)
## Check for linearity
plot(x=training.data$Status, y=full_lm$residuals,
main = "Check for linearity \n Residuals vs. Status")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(magrittr)
library(tidyverse)
data <- read.csv("C:/Users/14193/Downloads/Life Expectancy Data.csv") %>%
filter(Year==2014)
cluster_1=read.csv("~/Data-Mining-Final-Project/Clustered Data/cluster1.csv")
cluster_4=read.csv("~/Clustered Data/cluster4.csv")
cluster_4=read.csv("~OneDrive/Graduate school/Semester 4/Data Mining/Data-Mining-Final-Project/Clustered Datacluster4.csv")
cluster_4=read.csv("~/OneDrive/Graduate school/Semester 4/Data Mining/Data-Mining-Final-Project/Clustered Datacluster4.csv")
cluster_1=read.csv("C:/Users/hadamul/OneDrive/Graduate school/Semester 4/Data Mining/Data-Mining-Final-Project/Clustered Data/cluster1.csv")
cluster_2=read.csv("C:/Users/hadamul/OneDrive/Graduate school/Semester 4/Data Mining/Data-Mining-Final-Project/Clustered Data/cluster2.csv")
cluster_3=read.csv("C:/Users/hadamul/OneDrive/Graduate school/Semester 4/Data Mining/Data-Mining-Final-Project/Clustered Data/cluster3.csv")
cluster_4=read.csv("C:/Users/hadamul/OneDrive/Graduate school/Semester 4/Data Mining/Data-Mining-Final-Project/Clustered Datacluster4.csv")
cluster_1=read.csv("C:/Users/hadamul/OneDrive/Graduate school/Semester 4/Data Mining/Data-Mining-Final-Project/Clustered Data/cluster1.csv")
cluster_2=read.csv("C:/Users/hadamul/OneDrive/Graduate school/Semester 4/Data Mining/Data-Mining-Final-Project/Clustered Data/cluster2.csv")
cluster_3=read.csv("C:/Users/hadamul/OneDrive/Graduate school/Semester 4/Data Mining/Data-Mining-Final-Project/Clustered Data/cluster3.csv")
cluster_4=read.csv("C:/Users/hadamul/OneDrive/Graduate school/Semester 4/Data Mining/Data-Mining-Final-Project/Clustered Data/cluster4.csv")
View(cluster_4)
par(mfrow = c(3, 4))
plot(cluster_1$Diptheria,cluster_1$HALE_Birth, main="Check for linearity \n Response vs Diphtheria")
plot(cluster_1$BMI,cluster_1$HALE_Birth, main="Check for linearity \n Response vs BMI")
plot((cluster_1$Alcohol),cluster_1$HALE_Birth, main="Check for linearity \n Response vs ALCOHOL")
plot(cluster_1$Adult.Mortality,cluster_1$HALE_Birth, main="Check for linearity \n Response vs ADULT MORTALITY")
plot(cluster_1$HepB,cluster_1$HALE_Birth, main="Check for linearity \n Response vs HEPB")
plot((cluster_1$HIV),(cluster_1$HALE_Birth), main="Check for linearity \n Response  vs HIV")
plot(cluster_1$infant_mortality,cluster_1$HALE_Birth, main="Check for linearity \n Response vs infant mortality")
plot(cluster_1$percent.expenditure,cluster_1$HALE_Birth, main="Check for linearity \n Response  vs percent expenditure")
plot(cluster_1$Polio,cluster_1$HALE_Birth, main="Check for linearity \n Response vs Polio")
plot(cluster_1$thinness.5.19.years,cluster_1$HALE_Birth, main="Check for linearity \n Response  vs tthiness.5.19 ")
plot(cluster_1$total.expenditure,cluster_1$HALE_Birth, main="Check for linearity \n Response  vs total expenditure")
library(car)
lm_original_1=lm(HALE_Birth~., data=cluster_1[,-1])
vif(lm_original_1)
# The model suffers from huge multcollinearity
# CHECKING CONSTANTA VARIANCE ASSUMPTION
plot(lm_original_1$fitted.values, lm_original_1$residuals,
main = "Check for 0 mean and constant var \n  Residual vs. fitted value")
abline(h=0)
# The assumption for 0 meand and constant variance is satisfactory
par(mfrow = c(4, 4))
plot((cluster_1$Diptheria),cluster_1$HALE_Birth, main="Check for linearity \n Response vs Diphtheria")
plot((cluster_1$BMI),cluster_1$HALE_Birth, main="Check for linearity \n Response vs BMI")
plot(log(cluster_1$Alcohol+0.5),cluster_1$HALE_Birth, main="Check for linearity \n Response vs ALCOHOL")
plot((cluster_1$Adult.Mortality),cluster_1$HALE_Birth, main="Check for linearity \n Response vs ADULT MORTALITY")
plot((cluster_1$HepB)^5,cluster_1$HALE_Birth, main="Check for linearity \n Response vs HEPB")
plot((cluster_1$HIV),(cluster_1$HALE_Birth), main="Check for linearity \n Response  vs HIV")
## ignore this HIV
plot(log(cluster_1$infant_mortality),cluster_1$HALE_Birth, main="Check for linearity \n Response vs infant mortality")
plot(log(cluster_1$percent.expenditure),cluster_1$HALE_Birth, main="Check for linearity \n Response  vs percent expenditure")
plot((cluster_1$Polio),cluster_1$HALE_Birth, main="Check for linearity \n Response vs Polio")
plot((cluster_1$thinness.5.19.years),cluster_1$HALE_Birth, main="Check for linearity \n Response  vs tthiness.5.19 ")
plot((cluster_1$total.expenditure),cluster_1$HALE_Birth, main="Check for linearity \n Response  vs total expenditure")
# will not include HIV for linear regression
cluster_1$logAlcohol=log(cluster_1$Alcohol+0.5)
cluster_1$HepB_power_5=cluster_1$HepB^5
cluster_1$logInfant=log(cluster_1$infant_mortality)
cluster_1$logpercent_expenditure=log(cluster_1$percent.expenditure)
lm_cluster_1=lm(HALE_Birth ~Diptheria+Adult.Mortality+BMI + logAlcohol + HepB_power_5 +Polio+logpercent_expenditure+logInfant+ thinness.5.19.years+total.expenditure , data = cluster_1)
summary(lm_cluster_1)
vif(lm_cluster_1)
